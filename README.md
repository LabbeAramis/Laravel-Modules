Based on Nicolas Widart's package.

